extends layout



block content

  .container-fluid
    .row
      .col-sm-3.col-md-2.sidebar
        div.pixel-con
          img.pixel(src='/images/trophy.png' alt='trophy' width='60px')
          img.pixel(src='/images/bolt.png' alt='bolt' width='60px')
          img.pixel(src='/images/coin.png' alt='coin' width='60px')
          img.pixel(src='/images/heart.png' alt='heart' width='60px')
          img.pixel(src='/images/potion.png' alt='potion' width='60px')
          img.pixel(src='/images/shield.png' alt='shield' width='60px')
          img.pixel(src='/images/shroom.png' alt='shroom' width='60px')
          img.pixel(src='/images/start.png' alt='start' width='60px')
          img.pixel(src='/images/sword.png' alt='sword' width='60px')
          
      .col-sm-9.col-sm-offset-3.col-md-10.col-md-offset-2
        .container-dash
              .child-dash
                img.avatar(src=`${user.avatar}` )
              .child-dash
                p.user-dash-items=user.email
              .child-dash
                canvas.user-dash-items(id="habitChart" width="200" height="200")
             
              
        h2.title= title
        div
          a.btn.btn-primary(href='/tasks/create') Add New  
          .row.placeholders
            .col-xs-6.col-sm-3.placeholder
            
          form.form-inline.mt-2.mt-md-0
            input.form-control.mr-sm-2(type='text', placeholder='Search', aria-label='Search')
            button.btn.btn-outline-success.my-2.my-sm-0(type='submit') Search
          h2.sub-header 
          .table-responsive
            table.table.table-striped
              thead
                tr
                  th Category
                  th Difficulty
                  th Name
                  th Due Date
                  th Notes
                  th Repeating
                  th 
                  th
                  th
              tbody
              each task in tasks
                tr
                  td=task.category
                   td=task.difficulty
                  td
                    a.btn.btn-primary(href='/tasks/'+task._id)=task.name
                  if task.due_date !== undefined
                    td=task.due_date.toDateString()
                  td=task.notes
                  td=task.repeating
                  if task.completed != true
                    td
                      form(action=`/tasks/completed/${task._id}?_method=PUT`, method='POST')
                        button.btn.btn-primary(id='completed', name='completed' value='yes')  Mark Complete
                  else
                    td
                      p.btn.btn-success Completed
                  td
                      a.btn.btn-primary(href='/tasks/edit/'+ task._id) Edit  
                  td
                     button.btn.btn-primary(id='delete', value=task._id) Delete
        
  script.
  
     // delete fetch function for delete method
    const del = document.getElementById('delete')
    del.addEventListener('click', 
    function () {  
      fetch('/tasks/'+ del.value, {    
         method: 'DELETE'
        })  
        .then(res => {if (res.ok) return res.json()  })
        .then(data => {    
            console.log(data)    
            window.location.reload()  
            })
          .catch(err => console.log(err))
      })
    
              
   
