extends layout

  

block content
 
  .container-fluid
    .row
      .col-sm-3.col-md-2.sidebar
        h3 Rewards

      .col-sm-9.col-sm-offset-3.col-md-10.col-md-offset-2
        h2.title= title
        div
          a.btn.btn-primary(href='/tasks/create') Add New  
          .row.placeholders
            .col-xs-6.col-sm-3.placeholder

              canvas(id="taskChart" width="200" height="200")
              p This is not fully configured just in place


            .col-xs-6.col-sm-3.placeholder
              canvas(id="habitChart" width="200" height="200")
              p This is not fully configured just in place

          form.form-inline.mt-2.mt-md-0
            input.form-control.mr-sm-2(type='text', placeholder='Search', aria-label='Search')
            button.btn.btn-outline-success.my-2.my-sm-0(type='submit') Search


          h2.sub-header Tasks
          .table-responsive
            table.table.table-striped
              thead
                tr
                  th Category
                  th Name
                  th Due Date
                  th Description
                  th Repeating
                  th 
                  th
                  th
              tbody
              each task in tasks
                tr
                  td=task.category
                  td
                    a.btn.btn-primary(href='/tasks/'+task._id)=task.name
                  if task.due_date !== undefined
                    td=task.due_date.toDateString()
                  td=task.description
                  td=task.repeating
                  td
                    form
                      button.btn.btn-primary Mark Complete
                    td
                      a.btn.btn-primary(href='/tasks/edit') Edit  
                  td
                     button.btn.btn-primary(id='delete', value=task._id) Delete
        
  script.
    const del = document.getElementById('delete')
    del.addEventListener('click', 
    function () {  
      fetch('http://localhost:3009/tasks/'+ del.value, {    
         method: 'DELETE'
        })  
        .then(res => {if (res.ok) return res.json()  })
        .then(data => {    
            console.log(data)    
            window.location.reload()  
            })
          .catch(err => console.log(err))
      })
    
              
   
